# REST

Vamos falar sobre projeto de microsserviços baseados em REST e HTTP para alcançar serviços independentes acoplados com flexibilidade. Um dos aspectos mais importantes de aplicativos baseados em microsserviços é a capacidade de implantar microsserviços totalmente independentes um do outro. Para alcançar essa independência, cada microsserviço fornece um contrato com controle de versões para os clientes, que são outros microsserviços ou aplicativos. Os serviços não podem quebrar esses contratos com controle de versão até ser conhecido que nenhum outro microsserviço dependa de um contrato com controle de versão em particular. Lembre-se que outros microsserviços talvez precisem reverter para uma versão de código anterior que exija um contrato anterior. Lembre-se disso nas políticas de suspensão de uso e descontinuação.

Uma cultura que englobe contratos fortes e com versão talvez seja o aspecto organizacional mais desafiador de um aplicativo estável baseado em microsserviços. No nível mais baixo dos detalhes, os serviços se comunicam usando HTTPS com payloads em texto, como JSON ou XML, e usam verbos HTTP, como GET e POST, para dar significado às ações solicitadas. Os clientes precisam saber apenas os detalhes mínimos para usar o serviço: o URI, a solicitação e os formatos de mensagem da resposta. A arquitetura REST é compatível com acoplamento flexível. Em inglês, REST quer dizer "transferência de estado representativo" e tem independência de protocolo. HTTP é o protocolo mais comum, mas gRPC também é muito usado. REST é compatível com acoplamento flexível, mas ainda exige práticas de engenharia fortes para manter o acoplamento flexível.

Um ponto de partida é ter um contrato forte. Implementações com base em HTTP podem usar uma API aberta padrão. O gRPC fornece buffers de protocolo. Para ajudar a manter o acomplamento flexível, é essencial manter compatibilidade com versões anteriores do contrato e projetar uma API que englobe um domínio, e não casos de uso ou clientes específicos. Se não fizer isso, cada caso de uso novo ou aplicativo exigirá outra API REST especial, seja qual for o protocolo. Processamento de resposta de solicitação é o caso de uso comum, mas streaming também pode ser necessário e pode influenciar a escolha do protocolo. O gRPC é compatível com streaming, por exemplo.

Os recursos são identificados por URIs ou endpoints, e as respostas às solicitações retornam uma representação imutável das informações do recurso. Aplicações REST precisam fornecer interfaces uniformes consistentes e podem vincular a recursos adicionais. Hypermedia como o mecanismo do estado do aplicativo é um componente do REST, com o qual o cliente não precisa de muito conhecimento sobre um serviço, porque links para outros recursos são fornecidos como parte das respostas. É importante que o projeto da API seja parte do processo de desenvolvimento. O ideal é adotar um conjunto de regras de projeto para que as APIs REST tenham uma interface uniforme. Por exemplo, informar erros, ter a estrutura dos URLs, e usar paginação de maneiras consistentes. Além disso, considere armazenar em cache para mais desempenho e otimização de recursos para recursos imutáveis.

No REST, cliente e servidor trocam representações de um recurso. Um recurso é uma noção abstrata de informações. A representação de um recurso é uma cópia das informações dele. Por exemplo, um recurso pode representar um cão. A representação de um recurso são os dados reais de um cão. Por exemplo, o Noir, que é um Schnoodle, ou o Bree, que é um Mutt. Duas representações distintas de um recurso. O URI fornece acesso a um recurso. Fazer uma solicitação para esse recurso retorna uma representação dele, geralmente no formato JSON. O recurso solicitado pode ser de itens individuais ou uma coleção de itens. Por motivos de desempenho, é melhor retornar coleções de itens em vez de itens individuais. Esses tipos de operações geralmente são chamadas de APIs de lote. A representação de um recurso entre cliente e serviços é alcançada usando formatos padrões baseados em texto. JSON é a norma para formatos baseados em texto, mas XML também pode ser usado. Para APIs públicas ou externas, JSON é o padrão. Para serviços internos, gRPC pode ser usado, em especial se desempenho for essencial.